# ğŸ¤– AI Chat Configuration - Vertex AI

## âœ… Current Setup
- **AI Provider**: Google Cloud Vertex AI (Gemini)
- **Models**: gemini-2.0-flash-exp, gemini-2.5-pro
- **Authentication**: Service Account (JSON Key)

---

## ğŸš€ Quick Setup (5 phÃºt)

### 1. Láº¥y Google Cloud Credentials
Báº¡n Ä‘Ã£ cÃ³ key rá»“i, chá»‰ cáº§n:

```powershell
# Set environment variable (Windows PowerShell)
$env:GOOGLE_APPLICATION_CREDENTIALS="D:\Doan\Khoa_Luan_Tot_Nghiep\SportifyBackend\credentials\vertex-ai-key.json"
```

### 2. Cáº¥u hÃ¬nh Project ID
Má»Ÿ `src/main/resources/application.properties`:
```properties
vertex.ai.project.id=YOUR_PROJECT_ID  # â† Thay báº±ng project ID tháº­t
```

### 3. Run Application
```bash
mvn clean install
mvn spring-boot:run
```

---

## ğŸ“ File Structure

```
SportifyBackend/
â”œâ”€â”€ credentials/
â”‚   â””â”€â”€ vertex-ai-key.json          # â† Äáº·t JSON key á»Ÿ Ä‘Ã¢y
â”œâ”€â”€ src/main/java/duan/sportify/
â”‚   â””â”€â”€ service/impl/
â”‚       â”œâ”€â”€ GeminiServiceImpl.java  # âœ… Vertex AI (Primary)
â”‚       â””â”€â”€ OpenAIServiceImpl.java  # ğŸ’¡ OpenAI (Backup)
â””â”€â”€ src/main/resources/
    â””â”€â”€ application.properties      # Config
```

---

## ğŸ¯ Usage

### Frontend (AIChatbox)
```typescript
// Gá»­i message tá»± Ä‘á»™ng dÃ¹ng Gemini (Vertex AI)
fetch("http://localhost:8081/sportify/rest/ai/analyze", {
  method: "POST",
  body: JSON.stringify({ message: "TÃ¬m sÃ¢n bÃ³ng" })
});
```

### Backend (AIChatController)
```java
// Máº·c Ä‘á»‹nh dÃ¹ng Gemini (Vertex AI)
@PostMapping("/analyze")
public ResponseEntity analyze(@RequestBody Map<String, String> req) {
    String provider = req.getOrDefault("provider", "gemini"); // â† Máº·c Ä‘á»‹nh
    // ...
}
```

---

## ğŸ”§ Configuration Options

### application.properties
```properties
# Vertex AI Configuration
vertex.ai.project.id=your-project-id        # Project ID tá»« Google Cloud
vertex.ai.location=us-central1              # Region (hoáº·c asia-southeast1)
vertex.ai.model=gemini-2.0-flash-exp        # Model name
```

### Environment Variables
```powershell
# Required
GOOGLE_APPLICATION_CREDENTIALS=path/to/vertex-ai-key.json
```

---

## ğŸ› Troubleshooting

### Lá»—i: "Vertex AI Project ID chÆ°a Ä‘Æ°á»£c cáº¥u hÃ¬nh"
â†’ Update `vertex.ai.project.id` trong `application.properties`

### Lá»—i: "Application Default Credentials are not available"
â†’ Set `GOOGLE_APPLICATION_CREDENTIALS` environment variable

### Lá»—i: "Permission denied"
â†’ Check service account cÃ³ role "Vertex AI User"

---

## ğŸ“Š Model Options

| Model | Speed | Quality | Cost |
|-------|-------|---------|------|
| `gemini-2.0-flash-exp` | âš¡âš¡âš¡ Fast | â­â­â­ Good | ğŸ’° Low |
| `gemini-1.5-flash` | âš¡âš¡ Fast | â­â­â­â­ Great | ğŸ’° Low |
| `gemini-1.5-pro` | âš¡ Slower | â­â­â­â­â­ Best | ğŸ’°ğŸ’° Medium |
| `gemini-2.5-pro` | âš¡ Slower | â­â­â­â­â­ Best | ğŸ’°ğŸ’° Medium |

Thay Ä‘á»•i trong `application.properties`:
```properties
vertex.ai.model=gemini-1.5-pro  # Change model here
```

---

## ğŸ“š Documentation

- **Full Setup Guide**: `VERTEX_AI_SETUP.md`
- **Quick Start**: `QUICK_START.md`
- **Changelog**: `CHANGELOG_VERTEX_AI.md`

---

## âœ… Status
- âœ… Vertex AI integrated
- âœ… Old Gemini REST API removed
- âœ… Credentials secured (.gitignore)
- âœ… Ready for production

---

**Last Updated**: 2025-10-24  
**Version**: 2.0.0 (Vertex AI Only)
