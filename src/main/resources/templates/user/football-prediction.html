<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
<title>SPORTIFY - Dự đoán kết quả bóng đá</title>
<link rel="icon" href="/user/images/logotitle.png" type="image/x-icon">
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link
	href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,700;0,800;1,200;1,300;1,400;1,500;1,700&display=swap"
	rel="stylesheet">

<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<link rel="stylesheet" href="/user/css/animate.css">
<link rel="stylesheet" href="/user/css/owl.carousel.min.css">
<link rel="stylesheet" href="/user/css/owl.theme.default.min.css">
<link rel="stylesheet" href="/user/css/magnific-popup.css">
<link rel="stylesheet" href="/user/css/flaticon.css">
<link rel="stylesheet" href="/user/css/style.css">
<style>
body {
	background-image: url('/user/images/bgAll.png');
	background-repeat: repeat;
	background-size: cover;
	background-attachment: fixed;
	background-position: center;
	-webkit-backface-visibility: hidden;
	backface-visibility: hidden;
}
/* Điều chỉnh navigation menu hiển thị 1 hàng */
.navbar-nav {
	flex-wrap: nowrap !important;
}
.navbar-nav .nav-item {
	white-space: nowrap;
	margin-left: 5px !important;
	margin-right: 5px !important;
}
.navbar-nav .nav-link {
	font-size: 14px !important;
	padding-left: 12px !important;
	padding-right: 12px !important;
}
@media (max-width: 991px) {
	.navbar-nav .nav-link {
		font-size: 16px !important;
		padding: 10px 15px !important;
	}
	.navbar-nav .nav-item {
		margin-left: 3px !important;
		margin-right: 3px !important;
	}
}
/* Dropdown menu styles */
.dropdown-menu {
	background-color: #343a40 !important;
	border: none !important;
	border-radius: 5px !important;
	box-shadow: 0 4px 8px rgba(0,0,0,0.1) !important;
}
.dropdown-item {
	color: #fff !important;
	font-size: 14px !important;
	padding: 8px 16px !important;
}
.dropdown-item:hover {
	background-color: #495057 !important;
	color: #fff !important;
}
/* Prediction page styles */
.prediction-card {
	background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
	border-radius: 15px;
	color: white;
	padding: 20px;
	margin-bottom: 20px;
	box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}
.match-card {
	background: white;
	border-radius: 10px;
	padding: 20px;
	margin-bottom: 15px;
	box-shadow: 0 2px 8px rgba(0,0,0,0.1);
	border-left: 4px solid #28a745;
	transition: box-shadow 0.2s ease;
}
.match-card:hover {
	box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}
.team-logo {
	width: 50px;
	height: 50px;
	border-radius: 50%;
	object-fit: cover;
	background-color: #f8f9fa;
	background-image: url('/user/images/team-default.png');
	background-size: cover;
	background-position: center;
	transition: none;
	display: block;
	margin: 0 auto;
}
/* Fallback for missing images */
.team-logo[src=""] {
	background-image: url('/user/images/team-default.png');
}
.team-logo:not([src]) {
	background-image: url('/user/images/team-default.png');
}
/* Search and Filter Styles */
.search-filter-card {
	background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
	border: none;
	border-radius: 15px;
	box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
.search-filter-card .form-group label {
	font-weight: 600;
	color: #495057;
	margin-bottom: 8px;
}
.search-filter-card .form-control {
	border-radius: 25px;
	border: 2px solid #e9ecef;
	padding: 10px 20px;
	transition: all 0.3s ease;
}
.search-filter-card .form-control:focus {
	border-color: #28a745;
	box-shadow: 0 0 0 0.2rem rgba(40,167,69,0.25);
}
.search-filter-card .btn {
	border-radius: 25px;
	padding: 10px 25px;
	font-weight: 600;
	transition: all 0.3s ease;
}
.search-filter-card .btn-primary {
	background: linear-gradient(45deg, #28a745, #20c997);
	border: none;
}
.search-filter-card .btn-primary:hover {
	transform: translateY(-2px);
	box-shadow: 0 6px 20px rgba(40,167,69,0.3);
}
.match-item {
	transition: all 0.3s ease;
}
.match-item.hidden {
	display: none !important;
}
/* Autocomplete Styles */
.autocomplete-container {
	position: relative;
	width: 100%;
}
.suggestions-dropdown {
	position: absolute;
	top: 100%;
	left: 0;
	right: 0;
	background: white;
	border: 2px solid #e9ecef;
	border-top: none;
	border-radius: 0 0 15px 15px;
	max-height: 200px;
	overflow-y: auto;
	z-index: 1000;
	display: none;
	box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
.suggestion-item {
	padding: 12px 20px;
	cursor: pointer;
	border-bottom: 1px solid #f8f9fa;
	transition: all 0.2s ease;
	display: flex;
	align-items: center;
}
.suggestion-item:hover,
.suggestion-item.selected {
	background: linear-gradient(45deg, #28a745, #20c997);
	color: white;
}
.suggestion-item:last-child {
	border-bottom: none;
}
.suggestion-item .team-name {
	font-weight: 600;
	margin-right: 10px;
}
.suggestion-item .team-info {
	font-size: 12px;
	opacity: 0.8;
}
.suggestion-item .team-logo-small {
	width: 20px;
	height: 20px;
	border-radius: 50%;
	margin-right: 10px;
	object-fit: cover;
}
/* Custom Date Picker Styles */
#customDateGroup .input-group {
	border-radius: 25px;
	overflow: hidden;
}
#customDateGroup .form-control {
	border-radius: 25px 0 0 25px;
	border-right: none;
}
#customDateGroup .btn {
	border-radius: 0 25px 25px 0;
	border-left: none;
	background: #f8f9fa;
	border-color: #e9ecef;
	color: #6c757d;
}
#customDateGroup .btn:hover {
	background: #e9ecef;
	color: #495057;
}

/* Simple banner styles - no conflicting parent CSS */
.hero-wrap.hero-wrap-2 {
	height: 400px !important;
	min-height: 400px !important;
	background-size: cover !important;
	background-position: center !important;
	background-repeat: no-repeat !important;
	background-attachment: fixed !important;
}

.hero-wrap .slider-text {
	height: 750px !important;
	min-height: 750px !important;
	position: relative !important;
}
.prediction-btn {
	background: linear-gradient(45deg, #28a745, #20c997);
	border: none;
	color: white;
	padding: 10px 25px;
	border-radius: 25px;
	font-weight: bold;
	transition: background-color 0.2s ease;
}
.prediction-btn:hover {
	background: #28a745;
	color: white;
}
/* Khóa mục "Trực tiếp bóng đá" - chỉ cho phép click vào dropdown */
#footballDropdown {
	pointer-events: none !important;
	cursor: default !important;
}
#footballDropdown:hover {
	color: #fff !important;
}
</style>
</head>

<body>
	<div class="wrap" style="z-index: 9; position: relative">
		<div class="container">
			<div class="row">
				<div class="col-md-6 d-flex align-items-center">
					<div class="social-media mr-4 m-1">
						<p class="mb-0 d-flex">
							<a href="#"
								class="d-flex align-items-center justify-content-center"><span
								class="fa fa-facebook"><i class="sr-only">Facebook</i></span></a> <a
								href="#"
								class="d-flex align-items-center justify-content-center"><span
								class="fa fa-twitter"><i class="sr-only">Twitter</i></span></a> <a
								href="#"
								class="d-flex align-items-center justify-content-center"><span
								class="fa fa-instagram"><i class="sr-only">Instagram</i></span></a>
							<a href="#"
								class="d-flex align-items-center justify-content-center"><span
								class="fa fa-dribbble"><i class="sr-only">Dribbble</i></span></a>
						</p>
					</div>
					<p class="mb-0 phone pl-md-2">
						<a href="#" class="mr-2"><span class="fa fa-phone mr-1"></span>
							+00 1234 567</a> <a href="#"><span class="fa fa-paper-plane mr-1"></span>
							youremail@email.com</a>
					</p>
				</div>

				<div class="col-md-6 d-flex justify-content-md-end">
					<!-- check login -->
					<!-- Thẻ div để hiển thị khi chưa đăng nhập -->
					<div th:if="${users == null}" class="reg m-1"
						style="display: block;">
						<p class="mb-0">
							<a th:href="@{/sportify/login}" class="mr-2"
								style="color: white;">Đăng nhập |</a> 
							<a th:href="@{/sportify/signup}" style="color: white;">Đăng kí</a>
						</p>
					</div>

					<!-- Thẻ div để hiển thị khi đã đăng nhập -->
					<span th:if="${users != null}" class="m-1 mr-2"
						style="color: white;">Xin chào !</span>
					<div th:if="${users != null}" class="dropdown m-1"
						style="display: block;">
						<a class="dropdown-toggle " id="dropdownMenuAccount"
							data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							<img th:if=${users.image!=null}
							class="rounded-circle border border-white"
							th:src="@{'/user/images/' + ${users.image}}" alt=""
							style="width: 30px; height: 30px;"> <img
							th:if=${users.image==null}
							class="rounded-circle border border-white"
							src="/user/images/noavatar.jpg" alt=""
							style="width: 30px; height: 30px;"> <span id="nameuser"
							th:text="${users.firstname} + ' ' + ${users.lastname}"></span>
						</a>
						<div class="ml-3 mt-2 dropdown-menu"
							aria-labelledby="dropdownMenuButton">
							<a th:href="@{/sportify/profile}" class="dropdown-item">Thông
								tin</a> <a th:href="@{/sportify/field/profile/historybooking}"
								class="dropdown-item" href="#">Lịch sử đặt sân</a><a th:href="@{/sportify/order/historyList}"
								class="dropdown-item" href="#">Lịch sử đặt hàng</a> <a
								th:if="${authorized.roleid== 'R01' or authorized.roleid== 'R02'}"
								th:href="@{/sportify/admin}" class="dropdown-item">Quản trị</a>
							<a th:href="@{/sportify/logoff}" class="dropdown-item">Đăng
								xuất</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<nav
		class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light"
		id="ftco-navbar">
		<div class="container">
			<a class="navbar-brand" th:href="@{/sportify}"><img
				src="/user/images/Logo3.png" style="width: 350px;" alt=""></a>
			
			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#ftco-nav" aria-controls="ftco-nav"
				aria-expanded="false" aria-label="Toggle navigation">
				<span class="oi oi-menu"></span> Menu
			</button>

			<div class="collapse navbar-collapse" id="ftco-nav">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item"><a th:href="@{/sportify/field}"
						class="nav-link">Sân</a></li>
					<li class="nav-item"><a th:href="@{/sportify/team}"
						class="nav-link">Đội</a></li>
					<li class="nav-item"><a th:href="@{/sportify/event}"
						class="nav-link">Tin Tức</a></li>
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="footballDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							Trực tiếp bóng đá
						</a>
						<div class="dropdown-menu" aria-labelledby="footballDropdown">
							<a class="dropdown-item" th:href="@{/sportify/live-football}" target="_blank">Xem trực tiếp</a>
							<a class="dropdown-item" th:href="@{/sportify/football-prediction}">Dự đoán kết quả</a>
						</div>
					</li>
					<li class="nav-item"><a th:href="@{/sportify/product}"
						class="nav-link">Cửa hàng</a></li>
					<li class="nav-item"><a th:href="@{/sportify/about}"
						class="nav-link">Về chúng tôi</a></li>
					<li class="nav-item"><a th:href="@{/sportify/contact}"
						class="nav-link">Liên hệ</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<!-- END nav -->

	<section class="hero-wrap hero-wrap-2"
		style="background-image: url('/user/images/event3.png'); height: 400px !important; min-height: 400px !important;"
		data-stellar-background-ratio="0.5">
		<div class="overlay"></div>
		<div class="container">
			<div
				class="row no-gutters slider-text align-items-end justify-content-center"
				style="height: 750px !important; min-height: 750px !important; position: relative !important;">
				<div class="col-md-9 ftco-animate mb-5 text-center">
					<p class="breadcrumbs mb-0">
						<span class="mr-2"><a th:href="@{/sportify}">Trang Chủ <i
								class="fa fa-chevron-right"></i></a></span> <span>Dự đoán kết quả <i
							class="fa fa-chevron-right"></i></span>
					</p>
					<h2 class="mb-0 bread">Dự đoán kết quả</h2>
				</div>
			</div>
		</div>
	</section>

	<section class="ftco-section">
		<div class="container">
			<div class="row justify-content-center pb-5 mb-3">
				<div class="col-md-7 heading-section text-center ftco-animate">
					<h2>Dự đoán kết quả trận đấu</h2>
					<p>Sử dụng AI và dữ liệu thống kê để dự đoán kết quả các trận đấu bóng đá</p>
				</div>
			</div>



			<!-- Search and Filter Section -->
			<div class="row mb-4">
				<div class="col-md-12">
					<div class="card search-filter-card">
						<div class="card-body">
							<div class="row">
								<div class="col-md-6">
									<div class="form-group">
										<label for="searchInput"><i class="fa fa-search mr-2"></i>Tìm kiếm trận đấu</label>
										<div class="autocomplete-container">
											<input type="text" class="form-control" id="searchInput" placeholder="Nhập tên đội bóng..." autocomplete="off">
											<div id="suggestions" class="suggestions-dropdown"></div>
										</div>
									</div>
								</div>
								<div class="col-md-3">
									<div class="form-group">
										<label for="dateFilter">Lọc theo ngày</label>
										<select class="form-control" id="dateFilter">
											<option value="all">Tất cả ngày</option>
											<option value="today">Hôm nay</option>
											<option value="tomorrow">Ngày mai</option>
											<option value="week">Tuần này</option>
											<option value="custom">Chọn ngày cụ thể</option>
										</select>
									</div>
								</div>
								<div class="col-md-3">
									<div class="form-group" id="customDateGroup" style="display: none;">
										<label for="customDatePicker">Chọn ngày</label>
										<div class="input-group">
											<input type="date" class="form-control" id="customDatePicker">
											<div class="input-group-append">
												<button class="btn btn-outline-secondary" type="button" onclick="clearCustomDate()">
													<i class="fa fa-times"></i>
												</button>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12 text-center">
									<button class="btn btn-primary" onclick="filterMatches()">
										<i class="fa fa-filter mr-2"></i>Lọc kết quả
									</button>
									<button class="btn btn-secondary ml-2" onclick="location.reload()">
										<i class="fa fa-refresh mr-2"></i>Reset
									</button>
									<span class="ml-3 text-muted">
										Hiển thị <span id="matchCount">0</span> trận đấu
									</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="row" id="matchesContainer">
				<!-- Dynamic Matches from Football-Data.org with AI Predictions -->
				<div th:each="match : ${upcomingMatches}" class="col-md-6 mb-4 match-item" 
					 th:data-home-team="${match.homeTeam}" 
					 th:data-away-team="${match.awayTeam}"
					 th:data-date="${match.date}"
					 th:data-confidence="${match.aiConfidence ?: 0}">
					<div class="match-card">
						<div class="d-flex align-items-center justify-content-between mb-3">
							<div class="text-center">
								<img th:src="${match.homeTeamLogo ?: '/user/images/team-default.png'}" 
									 th:alt="${match.homeTeam}" class="team-logo mb-2" 
									 loading="lazy"
									 onerror="this.src='/user/images/team-default.png'">
								<h6 th:text="${match.homeTeam ?: 'Home Team'}">Home Team</h6>
							</div>
							<div class="text-center">
								<h4 class="text-primary">VS</h4>
								<small class="text-muted" th:text="${(match.time ?: '20:00') + ' - ' + (match.date ?: '2024-09-15')}">Time - Date</small>
								<br><small class="text-info" th:text="${match.competition ?: 'Premier League'}">Competition</small>
								<!-- AI Prediction Score -->
								<br><small class="text-success font-weight-bold" th:if="${match.predictedScore}" th:text="'AI: ' + ${match.predictedScore}">AI: 2-1</small>
							</div>
							<div class="text-center">
								<img th:src="${match.awayTeamLogo ?: '/user/images/team-default.png'}" 
									 th:alt="${match.awayTeam}" class="team-logo mb-2"
									 loading="lazy"
									 onerror="this.src='/user/images/team-default.png'">
								<h6 th:text="${match.awayTeam ?: 'Away Team'}">Away Team</h6>
							</div>
						</div>
						<div class="row text-center">
							<div class="col-4">
								<small>Thắng</small><br>
								<span class="badge badge-success" th:text="${(match.homeWinProbability ?: 35) + '%'}">35%</span>
							</div>
							<div class="col-4">
								<small>Hòa</small><br>
								<span class="badge badge-warning" th:text="${(match.drawProbability ?: 30) + '%'}">30%</span>
							</div>
							<div class="col-4">
								<small>Thắng</small><br>
								<span class="badge badge-success" th:text="${(match.awayWinProbability ?: 35) + '%'}">35%</span>
							</div>
						</div>
						<!-- AI Analysis -->
						<div class="text-center mt-2" th:if="${match.aiAnalysis}">
							<small class="text-muted" th:text="${match.aiAnalysis}">AI Analysis</small>
						</div>
						<!-- Recommendation -->
						<div class="text-center mt-2" th:if="${match.recommendation}">
							<small class="text-info font-weight-bold" th:text="${match.recommendation}">Recommendation</small>
						</div>
						<div class="text-center mt-3">
							<button class="prediction-btn" th:onclick="'showMatchDetails(' + ${match.id ?: 1} + ')'">
								Xem chi tiết 
							</button>
						</div>
					</div>
				</div>

				<!-- Show message if no matches available -->
				<div th:if="${#lists.isEmpty(upcomingMatches)}" class="col-md-12">
					<div class="alert alert-info text-center">
						<h4>Đang tải dữ liệu trận đấu...</h4>
						<p>Hệ thống đang kết nối với Football-Data.org API để lấy dữ liệu mới nhất</p>
						<button onclick="location.reload()" class="btn btn-primary">Thử lại</button>
						<a href="/sportify/football-test" class="btn btn-secondary ml-2">Debug Mode</a>
					</div>
				</div>
			</div>
			
			<!-- Pagination -->
			<div class="row mt-4" id="paginationContainer" style="display: none;">
				<div class="col-md-12 text-center">
					<nav aria-label="Match pagination">
						<ul class="pagination justify-content-center">
							<li class="page-item" id="prevPage">
								<a class="page-link" href="#" onclick="changePage(-1)">Trước</a>
							</li>
							<li class="page-item active" id="currentPage">
								<span class="page-link">1</span>
							</li>
							<li class="page-item" id="nextPage">
								<a class="page-link" href="#" onclick="changePage(1)">Sau</a>
							</li>
						</ul>
					</nav>
					<small class="text-muted">
						Hiển thị <span id="showingFrom">1</span> - <span id="showingTo">12</span> 
						trong tổng số <span id="totalMatches">0</span> trận đấu
					</small>
				</div>
			</div>

			
		</div>
	</section>

	<footer class="ftco-footer">
		<div class="container">
			<div class="row mb-5">
				<div class="col-sm-12 col-md">
					<div class="ftco-footer-widget mb-4">
						<h2 class="ftco-heading-2 logo">
							<a href="#">Sportify - Giải Pháp Sân Thể Thao</a>
						</h2>
						<p>Nền tảng đa năng cho đặt sân, tạo đội và mua sắm sản phẩm
							thể thao</p>
						<ul class="ftco-footer-social list-unstyled mt-2">
							<li class="ftco-animate"><a href="#"><span
									class="fa fa-twitter"></span></a></li>
							<li class="ftco-animate"><a
								href="https://www.facebook.com/profile.php?id=100094025267338"><span
									class="fa fa-facebook"></span></a></li>
							<li class="ftco-animate"><a href="#"><span
									class="fa fa-instagram"></span></a></li>
						</ul>
					</div>
				</div>

				<div class="col-sm-12 col-md">
					<div class="ftco-footer-widget mb-4 ml-md-4">
						<h2 class="ftco-heading-2">Chính sách và điều kiện</h2>
						<ul class="list-unstyled">
							<li><a th:href="@{/sportify/chinhsach}"><span
									class="fa fa-chevron-right mr-2"></span>Chính sách</a></li>
							<li><a th:href="@{/sportify/quydinh}"><span
									class="fa fa-chevron-right mr-2"></span>Quy Định & Điều Kiện</a></li>

						</ul>
					</div>
				</div>
				<div class="col-sm-12 col-md">
					<div class="ftco-footer-widget mb-4">
						<h2 class="ftco-heading-2">Liên Hệ Nhanh</h2>
						<ul class="list-unstyled">
							<li><a th:href="@{/sportify/contact}"><span
									class="fa fa-chevron-right mr-2"></span>Liên Hệ</a></li>

						</ul>
					</div>
				</div>
				<div class="col-sm-12 col-md">
					<div class="ftco-footer-widget mb-4">
						<h2 class="ftco-heading-2">Thông tin liên hệ</h2>
						<div class="block-23 mb-3">
							<ul>
								<li><span class="icon fa fa-map marker"></span><span
									class="text">104 Trần Bá Giao, Phường 5, Gò Vấp, Thành phố Hồ Chí Minh, Việt Nam</span></li>
								<li><a href="#"><span class="icon fa fa-phone"></span><span
										class="text">0366635625</span></a></li>
								<li><a href="#"><span
										class="icon fa fa-paper-plane pr-4"></span><span class="text">phamleducngoc123@gmail.com</span></a></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="container-fluid px-0 py-5 bg-black">
			<div class="container">
				<div class="row">
					<div class="col-md-12">

						<p class="mb-0" style="color: rgba(255, 255, 255, .5);">
							<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
							Bản quyền &copy;
							<script>
								document.write(new Date().getFullYear());
							</script>
							Bảo lưu mọi quyền | Mẫu này được thực hiện <i
								class="fa fa-heart color-danger" aria-hidden="true"></i> bởi <a
								th:href="@{/sportify/about}" target="_blank">Team Ngọc và Quí Sportify
							</a>
							<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
						</p>
					</div>
				</div>
			</div>
		</div>
	</footer>

	<!-- loader -->
	<div id="ftco-loader" class="show fullscreen">
		<svg class="circular" width="48px" height="48px">
			<circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke="#eeeeee" stroke-width="4" />
			<circle class="path" cx="24" cy="24" r="22" fill="none" stroke="#F96D00" stroke-width="4" stroke-miterlimit="10" />
		</svg>
	</div>

	<script src="/user/js/jquery.min.js"></script>
	<script src="/user/js/jquery-migrate-3.0.1.min.js"></script>
	<script src="/user/js/popper.min.js"></script>
	<script src="/user/js/bootstrap.min.js"></script>
	<script src="/user/js/jquery.easing.1.3.js"></script>
	<script src="/user/js/jquery.waypoints.min.js"></script>
	<script src="/user/js/jquery.stellar.min.js"></script>
	<script src="/user/js/owl.carousel.min.js"></script>
	<script src="/user/js/jquery.magnific-popup.min.js"></script>
	<script src="/user/js/jquery.animateNumber.min.js"></script>
	<script src="/user/js/scrollax.min.js"></script>
	<script src="/user/js/main.js"></script>
	
	<script>
		// Performance optimizations
		$(document).ready(function() {
			// Disable jQuery animations and stellar for better performance
			$.fx.off = false; // Keep animations but reduce
			
			// Disable stellar.js to prevent jitter
			if ($.stellar) {
				$.stellar.disable();
			}
			
			// Reduce animation duration globally
			$.fx.speeds._default = 200;
			
			// Lazy load images with error handling
			$('img[loading="lazy"]').each(function() {
				var img = this;
				var $img = $(img);
				
				// Set fallback background
				$img.css('background-image', 'url(/user/images/team-default.png)');
				
				if (img.complete) {
					$img.addClass('loaded');
				} else {
					$img.on('load', function() {
						$img.addClass('loaded');
					});
					$img.on('error', function() {
						// Hide broken image and show background
						$(this).css('opacity', '0');
						$(this).css('background-image', 'url(/user/images/team-default.png)');
						$(this).css('background-size', 'cover');
						$(this).css('background-position', 'center');
					});
				}
			});
			
			// Debounce scroll events to prevent jitter
			var scrollTimer = null;
			$(window).on('scroll', function() {
				if (scrollTimer) {
					clearTimeout(scrollTimer);
				}
				scrollTimer = setTimeout(function() {
					// Handle scroll events here if needed
				}, 16); // 60fps
			});
			
			// Simple fade in for cards without heavy animation
			$('.match-card').css('opacity', '0').each(function(index) {
				$(this).delay(index * 100).animate({opacity: 1}, 300);
			});
			
			// Disable parallax effects that can cause jitter
			$('[data-stellar-background-ratio]').removeAttr('data-stellar-background-ratio');
		});
		
		// Show match details function with detailed analysis
		function showMatchDetails(matchId) {
			console.log('Showing details for match:', matchId);
			
			// Find the match data by looking for the button that was clicked
			var $matchCard = null;
			
			// Try to find by looking for the button with the specific matchId
			$('.match-item').each(function() {
				var $this = $(this);
				var button = $this.find('button[onclick*="showMatchDetails(' + matchId + ')"]');
				if (button.length > 0) {
					$matchCard = $this;
					return false; // Break the loop
				}
			});
			
			// If still not found, try by index
			if (!$matchCard || $matchCard.length === 0) {
				var $allMatches = $('.match-item');
				var matchIndex = matchId - 1;
				if (matchIndex >= 0 && matchIndex < $allMatches.length) {
					$matchCard = $allMatches.eq(matchIndex);
				}
			}
			
			// If still not found, use the first visible match
			if (!$matchCard || $matchCard.length === 0) {
				$matchCard = $('.match-item:visible').first();
			}
			
			// If still not found, create a fallback with default data
			if (!$matchCard || $matchCard.length === 0) {
				console.log('No match card found, using fallback data');
				// Use fallback data instead of showing error
				var fallbackData = {
					matchId: matchId,
					homeTeam: 'Home Team',
					awayTeam: 'Away Team',
					matchDate: '2024-09-15',
					matchTime: '20:00',
					competition: 'Premier League',
					aiConfidence: 75,
					predictedScore: '2-1',
					homeWinProb: '40%',
					drawProb: '30%',
					awayWinProb: '30%',
					aiAnalysis: 'Phân tích AI mặc định',
					recommendation: 'Khuyến nghị mặc định',
					detailedFactors: generateDetailedFactors('Home Team', 'Away Team', 75)
				};
				
				var modalContent = createDetailedModalContent(fallbackData);
				showDetailedModal(modalContent);
				return;
			}
			
			// Extract match data with better fallbacks
			var homeTeam = $matchCard.data('home-team') || $matchCard.find('h6').first().text().trim() || 'Home Team';
			var awayTeam = $matchCard.data('away-team') || $matchCard.find('h6').last().text().trim() || 'Away Team';
			var matchDate = $matchCard.data('date') || '2024-09-15';
			
			// Extract time and date from the text
			var timeDateText = $matchCard.find('.text-muted').first().text() || '20:00 - 2024-09-15';
			var timeDateParts = timeDateText.split(' - ');
			var matchTime = timeDateParts[0] || '20:00';
			if (timeDateParts.length > 1) {
				matchDate = timeDateParts[1];
			}
			
			var competition = $matchCard.find('.text-info').first().text().trim() || 'Premier League';
			
			// Extract AI data with better selectors
			var aiConfidence = $matchCard.data('confidence') || 75;
			var predictedScore = $matchCard.find('.text-success').first().text().replace('AI: ', '').trim() || '2-1';
			
			// Extract probabilities from badges
			var badges = $matchCard.find('.badge');
			var homeWinProb = '40%';
			var drawProb = '30%';
			var awayWinProb = '30%';
			
			if (badges.length >= 3) {
				homeWinProb = badges.eq(0).text() || '40%';
				drawProb = badges.eq(1).text() || '30%';
				awayWinProb = badges.eq(2).text() || '30%';
			}
			
			var aiAnalysis = $matchCard.find('.text-muted').last().text().trim() || 'Phân tích AI';
			var recommendation = $matchCard.find('.text-info').last().text().trim() || 'Khuyến nghị';
			
			// Debug logging
			console.log('Extracted data:', {
				homeTeam: homeTeam,
				awayTeam: awayTeam,
				matchDate: matchDate,
				matchTime: matchTime,
				competition: competition,
				aiConfidence: aiConfidence,
				predictedScore: predictedScore,
				homeWinProb: homeWinProb,
				drawProb: drawProb,
				awayWinProb: awayWinProb,
				aiAnalysis: aiAnalysis,
				recommendation: recommendation
			});
			
			// Generate detailed analysis factors (simulated)
			var detailedFactors = generateDetailedFactors(homeTeam, awayTeam, aiConfidence);
			
			// Create detailed modal content
			var modalContent = createDetailedModalContent({
				matchId: matchId,
				homeTeam: homeTeam,
				awayTeam: awayTeam,
				matchDate: matchDate,
				matchTime: matchTime,
				competition: competition,
				aiConfidence: aiConfidence,
				predictedScore: predictedScore,
				homeWinProb: homeWinProb,
				drawProb: drawProb,
				awayWinProb: awayWinProb,
				aiAnalysis: aiAnalysis,
				recommendation: recommendation,
				detailedFactors: detailedFactors
			});
			
			// Show modal
			showDetailedModal(modalContent);
		}
		
		// Generate detailed factors for analysis
		function generateDetailedFactors(homeTeam, awayTeam, confidence) {
			var factors = {
				formAnalysis: {
					homeForm: generateFormData(homeTeam),
					awayForm: generateFormData(awayTeam)
				},
				headToHead: generateHeadToHeadData(homeTeam, awayTeam),
				keyFactors: generateKeyFactors(homeTeam, awayTeam),
				riskAssessment: generateRiskAssessment(confidence),
				statistics: generateMatchStatistics(homeTeam, awayTeam),
				weatherConditions: generateWeatherData(),
				injuryReport: generateInjuryReport(homeTeam, awayTeam),
				motivationFactors: generateMotivationFactors(homeTeam, awayTeam)
			};
			return factors;
		}
		
		// Generate form data for teams
		function generateFormData(teamName) {
			var forms = ['W', 'D', 'L', 'W', 'W'];
			var points = 0;
			forms.forEach(function(result) {
				if (result === 'W') points += 3;
				else if (result === 'D') points += 1;
			});
			return {
				last5: forms,
				points: points,
				streak: getStreak(forms),
				homeAway: Math.random() > 0.5 ? 'Tốt' : 'Trung bình'
			};
		}
		
		// Generate head-to-head data
		function generateHeadToHeadData(team1, team2) {
			return {
				totalMatches: 12,
				team1Wins: 5,
				team2Wins: 4,
				draws: 3,
				lastMeeting: '2024-03-15',
				lastResult: '2-1',
				lastWinner: team1,
				trend: 'Cân bằng'
			};
		}
		
		// Generate key factors
		function generateKeyFactors(homeTeam, awayTeam) {
			var factors = [
				'Phong độ tốt của ' + homeTeam,
				'Lợi thế sân nhà',
				'Chấn thương quan trọng ở ' + awayTeam,
				'Động lực cao cho trận đấu',
				'Thời tiết thuận lợi'
			];
			return factors.slice(0, Math.floor(Math.random() * 3) + 2);
		}
		
		// Generate risk assessment
		function generateRiskAssessment(confidence) {
			if (confidence > 80) return { level: 'Thấp', description: 'Dự đoán chắc chắn' };
			if (confidence > 65) return { level: 'Trung Bình', description: 'Dự đoán khá chắc chắn' };
			return { level: 'Cao', description: 'Dự đoán có rủi ro' };
		}
		
		// Generate match statistics
		function generateMatchStatistics(homeTeam, awayTeam) {
			return {
				avgGoalsFor: { home: 2.1, away: 1.8 },
				avgGoalsAgainst: { home: 1.2, away: 1.5 },
				possession: { home: 58, away: 42 },
				shotsOnTarget: { home: 6.2, away: 4.8 },
				cleanSheets: { home: 8, away: 6 }
			};
		}
		
		// Generate weather data
		function generateWeatherData() {
			var conditions = ['Nắng', 'Mây', 'Mưa nhẹ', 'Gió mạnh'];
			return {
				condition: conditions[Math.floor(Math.random() * conditions.length)],
				temperature: 18 + Math.floor(Math.random() * 10),
				humidity: 60 + Math.floor(Math.random() * 20),
				windSpeed: Math.floor(Math.random() * 15)
			};
		}
		
		// Generate injury report
		function generateInjuryReport(homeTeam, awayTeam) {
			return {
				homeInjuries: Math.random() > 0.7 ? ['Cầu thủ A', 'Cầu thủ B'] : [],
				awayInjuries: Math.random() > 0.8 ? ['Cầu thủ X'] : [],
				suspensions: Math.random() > 0.9 ? ['Cầu thủ Y'] : []
			};
		}
		
		// Generate motivation factors
		function generateMotivationFactors(homeTeam, awayTeam) {
			var factors = [];
			if (isDerbyMatch(homeTeam, awayTeam)) {
				factors.push('Trận derby - động lực cao');
			}
			if (isBigTeam(homeTeam)) {
				factors.push('Áp lực thi đấu lớn');
			}
			factors.push('Vị trí trên bảng xếp hạng');
			return factors;
		}
		
		// Helper functions
		function getStreak(forms) {
			var current = forms[0];
			var count = 1;
			for (var i = 1; i < forms.length; i++) {
				if (forms[i] === current) count++;
				else break;
			}
			return count + ' ' + (current === 'W' ? 'thắng' : current === 'D' ? 'hòa' : 'thua');
		}
		
		function isDerbyMatch(team1, team2) {
			var derbies = [
				['Manchester United', 'Manchester City'],
				['Arsenal', 'Tottenham Hotspur'],
				['Liverpool', 'Everton']
			];
			return derbies.some(function(derby) {
				return (derby[0] === team1 && derby[1] === team2) || 
					   (derby[0] === team2 && derby[1] === team1);
			});
		}
		
		function isBigTeam(team) {
			var bigTeams = ['Manchester City', 'Arsenal', 'Liverpool', 'Manchester United', 'Chelsea', 'Tottenham Hotspur'];
			return bigTeams.includes(team);
		}
		
		// Create detailed modal content
		function createDetailedModalContent(data) {
			var factors = data.detailedFactors;
			return `
				<div class="modal fade" id="matchDetailsModal" tabindex="-1" role="dialog">
					<div class="modal-dialog modal-lg" role="document">
						<div class="modal-content">
							<div class="modal-header bg-primary text-white">
								<h5 class="modal-title">
									<i class="fa fa-chart-line mr-2"></i>
									Phân tích chi tiết: ${data.homeTeam} vs ${data.awayTeam}
								</h5>
								<button type="button" class="close text-white" data-dismiss="modal">
									<span>&times;</span>
								</button>
							</div>
							<div class="modal-body">
								<!-- Match Info -->
								<div class="row mb-4">
									<div class="col-md-6">
										<h6><i class="fa fa-calendar mr-2"></i>Thông tin trận đấu</h6>
										<p><strong>Ngày:</strong> ${data.matchDate}</p>
										<p><strong>Giờ:</strong> ${data.matchTime}</p>
										<p><strong>Giải đấu:</strong> ${data.competition}</p>
									</div>
									<div class="col-md-6">
										<h6><i class="fa fa-trophy mr-2"></i>Dự đoán AI</h6>
										<p><strong>Tỷ số dự đoán:</strong> <span class="badge badge-success">${data.predictedScore}</span></p>
										<p><strong>Độ tin cậy:</strong> <span class="badge badge-info">${data.aiConfidence}%</span></p>
										<p><strong>Khuyến nghị:</strong> ${data.recommendation}</p>
									</div>
								</div>
								
								<!-- Probabilities -->
								<div class="row mb-4">
									<div class="col-12">
										<h6><i class="fa fa-percentage mr-2"></i>Xác suất kết quả</h6>
										<div class="progress mb-2">
											<div class="progress-bar bg-success" style="width: ${data.homeWinProb}">${data.homeWinProb} Thắng</div>
										</div>
										<div class="progress mb-2">
											<div class="progress-bar bg-warning" style="width: ${data.drawProb}">${data.drawProb} Hòa</div>
										</div>
										<div class="progress mb-2">
											<div class="progress-bar bg-info" style="width: ${data.awayWinProb}">${data.awayWinProb} Thắng</div>
										</div>
									</div>
								</div>
								
								<!-- Detailed Analysis -->
								<div class="row">
									<div class="col-md-6">
										<h6><i class="fa fa-chart-bar mr-2"></i>Phong độ gần đây</h6>
										<div class="card">
											<div class="card-body">
												<p><strong>${data.homeTeam}:</strong> ${factors.formAnalysis.homeForm.last5.join(' ')} (${factors.formAnalysis.homeForm.points} điểm)</p>
												<p><strong>${data.awayTeam}:</strong> ${factors.formAnalysis.awayForm.last5.join(' ')} (${factors.formAnalysis.awayForm.points} điểm)</p>
											</div>
										</div>
										
										<h6 class="mt-3"><i class="fa fa-history mr-2"></i>Lịch sử đối đầu</h6>
										<div class="card">
											<div class="card-body">
												<p><strong>Tổng trận:</strong> ${factors.headToHead.totalMatches}</p>
												<p><strong>${data.homeTeam} thắng:</strong> ${factors.headToHead.team1Wins}</p>
												<p><strong>${data.awayTeam} thắng:</strong> ${factors.headToHead.team2Wins}</p>
												<p><strong>Hòa:</strong> ${factors.headToHead.draws}</p>
												<p><strong>Trận gần nhất:</strong> ${factors.headToHead.lastResult} (${factors.headToHead.lastWinner})</p>
											</div>
										</div>
									</div>
									
									<div class="col-md-6">
										<h6><i class="fa fa-exclamation-triangle mr-2"></i>Yếu tố chính</h6>
										<div class="card">
											<div class="card-body">
												${factors.keyFactors.map(factor => `<span class="badge badge-light mr-1 mb-1">${factor}</span>`).join('')}
											</div>
										</div>
										
										<h6 class="mt-3"><i class="fa fa-shield-alt mr-2"></i>Đánh giá rủi ro</h6>
										<div class="card">
											<div class="card-body">
												<p><strong>Mức độ:</strong> <span class="badge badge-${factors.riskAssessment.level === 'Thấp' ? 'success' : factors.riskAssessment.level === 'Trung Bình' ? 'warning' : 'danger'}">${factors.riskAssessment.level}</span></p>
												<p><strong>Mô tả:</strong> ${factors.riskAssessment.description}</p>
											</div>
										</div>
									</div>
								</div>
								
								<!-- Statistics -->
								<div class="row mt-3">
									<div class="col-12">
										<h6><i class="fa fa-chart-pie mr-2"></i>Thống kê chi tiết</h6>
										<div class="row">
											<div class="col-md-4">
												<div class="card text-center">
													<div class="card-body">
														<h6>Bàn thắng trung bình</h6>
														<p><strong>${data.homeTeam}:</strong> ${factors.statistics.avgGoalsFor.home}</p>
														<p><strong>${data.awayTeam}:</strong> ${factors.statistics.avgGoalsFor.away}</p>
													</div>
												</div>
											</div>
											<div class="col-md-4">
												<div class="card text-center">
													<div class="card-body">
														<h6>Kiểm soát bóng</h6>
														<p><strong>${data.homeTeam}:</strong> ${factors.statistics.possession.home}%</p>
														<p><strong>${data.awayTeam}:</strong> ${factors.statistics.possession.away}%</p>
													</div>
												</div>
											</div>
											<div class="col-md-4">
												<div class="card text-center">
													<div class="card-body">
														<h6>Thời tiết</h6>
														<p><strong>Điều kiện:</strong> ${factors.weatherConditions.condition}</p>
														<p><strong>Nhiệt độ:</strong> ${factors.weatherConditions.temperature}°C</p>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								
								<!-- AI Analysis -->
								<div class="row mt-3">
									<div class="col-12">
										<h6><i class="fa fa-brain mr-2"></i>Phân tích AI</h6>
										<div class="alert alert-info">
											<p><strong>${data.aiAnalysis}</strong></p>
											<p><strong>Khuyến nghị:</strong> ${data.recommendation}</p>
										</div>
									</div>
								</div>
							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
								<button type="button" class="btn btn-primary" onclick="shareMatchAnalysis(${data.matchId})">
									<i class="fa fa-share mr-1"></i>Chia sẻ
								</button>
							</div>
						</div>
					</div>
				</div>
			`;
		}
		
		// Show detailed modal
		function showDetailedModal(modalContent) {
			// Remove existing modal if any
			$('#matchDetailsModal').remove();
			
			// Add modal to body
			$('body').append(modalContent);
			
			// Show modal
			$('#matchDetailsModal').modal('show');
		}
		
		// Share match analysis
		function shareMatchAnalysis(matchId) {
			// Simple share functionality
			if (navigator.share) {
				navigator.share({
					title: 'Phân tích trận đấu',
					text: 'Xem phân tích chi tiết trận đấu #' + matchId,
					url: window.location.href
				});
			} else {
				// Fallback - copy to clipboard
				navigator.clipboard.writeText(window.location.href).then(function() {
					alert('Link đã được sao chép vào clipboard!');
				});
			}
		}
		
		// Suppress console errors for missing images
		window.addEventListener('error', function(e) {
			if (e.target.tagName === 'IMG' && e.target.src.includes('team-default.png')) {
				e.preventDefault();
				return false;
			}
		}, true);
		
		// Search and Filter Functions
		function filterMatches() {
			var searchTerm = $('#searchInput').val().toLowerCase().trim();
			var dateFilter = $('#dateFilter').val();
			var customDate = $('#customDatePicker').val();
			
			var $matches = $('.match-item');
			var visibleCount = 0;
			
			// Remove any existing messages
			$('#instructionMessage').remove();
			$('#matchesContainer .alert-info').remove();
			$('#matchesContainer .alert-warning').remove();
			
			$matches.each(function() {
				var $match = $(this);
				var homeTeam = $match.data('home-team').toLowerCase();
				var awayTeam = $match.data('away-team').toLowerCase();
				var matchDate = $match.data('date');
				var confidence = $match.data('confidence');
				
				var showMatch = true;
				
				// Enhanced search filter - more detailed matching
				if (searchTerm) {
					var searchWords = searchTerm.split(/\s+/); // Split by spaces
					var matchFound = false;
					
					// Check if ALL search words are found in either team name
					for (var i = 0; i < searchWords.length; i++) {
						var word = searchWords[i];
						if (homeTeam.includes(word) || awayTeam.includes(word)) {
							matchFound = true;
						} else {
							matchFound = false;
							break; // If any word doesn't match, stop checking
						}
					}
					
					// Also check for partial team name matches
					if (!matchFound) {
						// Check if search term is contained in any team name
						if (homeTeam.includes(searchTerm) || awayTeam.includes(searchTerm)) {
							matchFound = true;
						}
					}
					
					if (!matchFound) {
						showMatch = false;
					}
				}
				
				// Date filter
				if (dateFilter !== 'all') {
					var today = new Date();
					var matchDateObj = new Date(matchDate);
					
					switch(dateFilter) {
						case 'today':
							if (matchDateObj.toDateString() !== today.toDateString()) {
								showMatch = false;
							}
							break;
						case 'tomorrow':
							var tomorrow = new Date(today);
							tomorrow.setDate(tomorrow.getDate() + 1);
							if (matchDateObj.toDateString() !== tomorrow.toDateString()) {
								showMatch = false;
							}
							break;
						case 'week':
							var weekFromNow = new Date(today);
							weekFromNow.setDate(weekFromNow.getDate() + 7);
							if (matchDateObj < today || matchDateObj > weekFromNow) {
								showMatch = false;
							}
							break;
						case 'custom':
							if (customDate) {
								var selectedDate = new Date(customDate);
								var matchDateOnly = new Date(matchDateObj.getFullYear(), matchDateObj.getMonth(), matchDateObj.getDate());
								var selectedDateOnly = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), selectedDate.getDate());
								
								if (matchDateOnly.getTime() !== selectedDateOnly.getTime()) {
									showMatch = false;
								}
							} else {
								showMatch = false; // No custom date selected
							}
							break;
					}
				}
				
				if (showMatch) {
					$match.show();
					visibleCount++;
				} else {
					$match.hide();
				}
			});
			
			// No sorting - keep original order
			
			// Update count and pagination
			totalMatches = visibleCount;
			$('#matchCount').text(visibleCount);
			$('#totalMatches').text(visibleCount);
			
			// Reset to first page
			currentPage = 1;
			
			// Show message if no matches
			if (visibleCount === 0) {
				var searchInfo = searchTerm ? ' cho "' + searchTerm + '"' : '';
				var dateInfo = dateFilter !== 'all' ? ' trong ' + $('#dateFilter option:selected').text().toLowerCase() : '';
				$('#matchesContainer').append('<div class="col-md-12"><div class="alert alert-warning text-center"><h5><i class="fa fa-search mr-2"></i>Không tìm thấy trận đấu nào</h5><p>Không có kết quả' + searchInfo + dateInfo + '</p><p><small>Thử thay đổi từ khóa tìm kiếm hoặc bộ lọc khác</small></p></div></div>');
				$('#paginationContainer').hide();
			} else {
				// Show pagination if needed
				if (visibleCount > matchesPerPage) {
					showPage(1);
					updatePaginationUI();
				} else {
					$('.match-item:visible').show();
					$('#paginationContainer').hide();
				}
			}
		}
		
		
		function resetFilters() {
			console.log('=== RESET FILTERS START ===');
			
			// Reset all form inputs
			$('#searchInput').val('');
			$('#dateFilter').val('all');
			$('#customDatePicker').val('');
			$('#customDateGroup').hide();
			
			// Show ALL matches (like original page load)
			$('.match-item').show().removeClass('hidden');
			
			// Remove any messages
			$('#matchesContainer .alert-info').remove();
			$('#matchesContainer .alert-warning').remove();
			
			// Reset pagination variables
			totalMatches = $('.match-item').length;
			currentPage = 1;
			
			// Update counters
			$('#matchCount').text(totalMatches);
			$('#totalMatches').text(totalMatches);
			
			// Reset pagination UI
			if (totalMatches > matchesPerPage) {
				showPage(1);
				updatePaginationUI();
			} else {
				$('.match-item').show();
				$('#paginationContainer').hide();
			}
			
			console.log('Reset completed. Total matches:', totalMatches);
			console.log('Visible matches:', $('.match-item:visible').length);
		}
		
		// Autocomplete functionality
		var allTeams = [];
		var selectedSuggestion = -1;
		
		// Initialize team data for autocomplete
		function initializeTeamData() {
			allTeams = [];
			$('.match-item').each(function() {
				var homeTeam = $(this).data('home-team');
				var awayTeam = $(this).data('away-team');
				var homeLogo = $(this).find('.team-logo').first().attr('src');
				var awayLogo = $(this).find('.team-logo').last().attr('src');
				
				if (homeTeam && allTeams.findIndex(t => t.name === homeTeam) === -1) {
					allTeams.push({
						name: homeTeam,
						logo: homeLogo || '/user/images/team-default.png',
						type: 'Home Team'
					});
				}
				
				if (awayTeam && allTeams.findIndex(t => t.name === awayTeam) === -1) {
					allTeams.push({
						name: awayTeam,
						logo: awayLogo || '/user/images/team-default.png',
						type: 'Away Team'
					});
				}
			});
			
			// Add some popular team suggestions
			var popularTeams = [
				{name: 'Arsenal FC', logo: '/user/images/team4.png', type: 'Popular'},
				{name: 'Manchester United FC', logo: '/user/images/team1.png', type: 'Popular'},
				{name: 'Liverpool FC', logo: '/user/images/team2.png', type: 'Popular'},
				{name: 'Chelsea FC', logo: '/user/images/team3.png', type: 'Popular'},
				{name: 'Manchester City FC', logo: '/user/images/team5.png', type: 'Popular'},
				{name: 'Tottenham Hotspur FC', logo: '/user/images/team6.png', type: 'Popular'}
			];
			
			popularTeams.forEach(team => {
				if (allTeams.findIndex(t => t.name === team.name) === -1) {
					allTeams.unshift(team); // Add to beginning
				}
			});
			
			console.log('Initialized ' + allTeams.length + ' teams for autocomplete');
		}
		
		// Show suggestions
		function showSuggestions(query) {
			if (!query || query.length < 2) {
				$('#suggestions').hide();
				return;
			}
			
			var filteredTeams = allTeams.filter(team => 
				team.name.toLowerCase().includes(query.toLowerCase())
			).slice(0, 8); // Limit to 8 suggestions
			
			if (filteredTeams.length === 0) {
				$('#suggestions').hide();
				return;
			}
			
			var suggestionsHtml = '';
			filteredTeams.forEach((team, index) => {
				suggestionsHtml += `
					<div class="suggestion-item" data-team="${team.name}" data-index="${index}">
						<img src="${team.logo}" alt="${team.name}" class="team-logo-small" onerror="this.src='/user/images/team-default.png'">
						<div>
							<div class="team-name">${team.name}</div>
							<div class="team-info">${team.type}</div>
						</div>
					</div>
				`;
			});
			
			$('#suggestions').html(suggestionsHtml).show();
			selectedSuggestion = -1;
		}
		
		// Hide suggestions
		function hideSuggestions() {
			setTimeout(() => {
				$('#suggestions').hide();
			}, 200);
		}
		
		// Handle input events
		$('#searchInput').on('input', function() {
			var query = $(this).val();
			showSuggestions(query);
		});
		
		// Handle date filter change
		$('#dateFilter').on('change', function() {
			var selectedValue = $(this).val();
			if (selectedValue === 'custom') {
				$('#customDateGroup').show();
				// Set today as default
				var today = new Date().toISOString().split('T')[0];
				$('#customDatePicker').val(today);
			} else {
				$('#customDateGroup').hide();
				$('#customDatePicker').val('');
			}
		});
		
		// Clear custom date function
		window.clearCustomDate = function() {
			$('#customDatePicker').val('');
			$('#dateFilter').val('all');
			$('#customDateGroup').hide();
		};
		
		// Handle suggestion click
		$(document).on('click', '.suggestion-item', function() {
			var teamName = $(this).data('team');
			$('#searchInput').val(teamName);
			$('#suggestions').hide();
		});
		
		// Handle keyboard navigation
		$('#searchInput').on('keydown', function(e) {
			var $suggestions = $('#suggestions');
			var $items = $suggestions.find('.suggestion-item');
			
			if (e.key === 'ArrowDown') {
				e.preventDefault();
				selectedSuggestion = Math.min(selectedSuggestion + 1, $items.length - 1);
				$items.removeClass('selected').eq(selectedSuggestion).addClass('selected');
			} else if (e.key === 'ArrowUp') {
				e.preventDefault();
				selectedSuggestion = Math.max(selectedSuggestion - 1, -1);
				$items.removeClass('selected').eq(selectedSuggestion).addClass('selected');
			} else if (e.key === 'Enter') {
				e.preventDefault();
				if (selectedSuggestion >= 0) {
					var teamName = $items.eq(selectedSuggestion).data('team');
					$('#searchInput').val(teamName);
					$('#suggestions').hide();
				}
			} else if (e.key === 'Escape') {
				$('#suggestions').hide();
			}
		});
		
		// Hide suggestions when clicking outside
		$(document).on('click', function(e) {
			if (!$(e.target).closest('.autocomplete-container').length) {
				$('#suggestions').hide();
			}
		});
		
		// Pagination variables
		var currentPage = 1;
		var matchesPerPage = 12;
		var totalMatches = 0;
		
		// Pagination functions
		function changePage(direction) {
			var newPage = currentPage + direction;
			var totalPages = Math.ceil(totalMatches / matchesPerPage);
			
			if (newPage >= 1 && newPage <= totalPages) {
				currentPage = newPage;
				showPage(currentPage);
				updatePaginationUI();
			}
		}
		
		function showPage(page) {
			var startIndex = (page - 1) * matchesPerPage;
			var endIndex = startIndex + matchesPerPage;
			
			// If total matches <= matchesPerPage, show all
			if (totalMatches <= matchesPerPage) {
				$('.match-item').show();
				$('#showingFrom').text(1);
				$('#showingTo').text(totalMatches);
				return;
			}
			
			// Otherwise, show only the current page
			$('.match-item').each(function(index) {
				if (index >= startIndex && index < endIndex) {
					$(this).show();
				} else {
					$(this).hide();
				}
			});
			
			$('#showingFrom').text(startIndex + 1);
			$('#showingTo').text(Math.min(endIndex, totalMatches));
		}
		
		function updatePaginationUI() {
			var totalPages = Math.ceil(totalMatches / matchesPerPage);
			
			$('#currentPage span').text(currentPage);
			$('#prevPage').toggleClass('disabled', currentPage === 1);
			$('#nextPage').toggleClass('disabled', currentPage === totalPages);
			
			// Only show pagination if we have more than matchesPerPage matches
			if (totalMatches > matchesPerPage) {
				$('#paginationContainer').show();
			} else {
				$('#paginationContainer').hide();
			}
		}
		
		// Initialize match count and pagination
		$(document).ready(function() {
			totalMatches = $('.match-item').length;
			$('#matchCount').text(totalMatches);
			$('#totalMatches').text(totalMatches);
			
			// Initialize autocomplete data
			initializeTeamData();
			
			// Show all matches initially (like original)
			$('.match-item').show();
			
			// Apply pagination if needed
			if (totalMatches > matchesPerPage) {
				showPage(1);
				updatePaginationUI();
			} else {
				$('#paginationContainer').hide();
			}
		});
		
		// Khóa mục "Trực tiếp bóng đá" - chỉ cho phép click vào dropdown
		document.addEventListener('DOMContentLoaded', function() {
			const footballDropdown = document.getElementById('footballDropdown');
			const footballDropdownMenu = footballDropdown.nextElementSibling;
			
			// Ngăn chặn click vào link chính
			footballDropdown.addEventListener('click', function(e) {
				e.preventDefault();
				e.stopPropagation();
			});
			
			// Cho phép dropdown hoạt động khi click vào mũi tên
			footballDropdown.addEventListener('click', function(e) {
				if (footballDropdownMenu.classList.contains('show')) {
					footballDropdownMenu.classList.remove('show');
				} else {
					footballDropdownMenu.classList.add('show');
				}
			});
		});
	</script>

</body>
</html>
